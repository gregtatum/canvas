import * as Quads from "../";
import { assertArt, replaceCodepoint } from "./helpers";

describe("QuadMesh", () => {
  it("can create a quad from positions", () => {
    const { mesh } = Quads.createQuad({
      positions: [
        [-4.0, 0.0, -3.0],
        [-4.0, 0.0, 3.0],
        [1.0, 0.0, 3.0],
        [1.0, 0.0, -3.0],
      ],
    });

    assertArt(
      mesh,
      "y",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  Â·  Â·  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚  3  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  Â·  Â·  Â·
      â”‚  4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can create a quad from size", () => {
    const { mesh } = Quads.createQuad({ w: 2, h: 4, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -2  Â·  Â·  Â·  Â·  â—†â”â”â”â”â”â—†  Â·  Â·  Â·  Â·
      â”‚ -1  Â·  Â·  Â·  Â·  â”ƒ  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  Â·  Â·  â”ƒ  â”Š  â”ƒ  Â·  Â·  Â·  Â·
      â”‚  2  Â·  Â·  Â·  Â·  â—†â”â”â”â”â”â—†  Â·  Â·  Â·  Â·
      â”‚  3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can split a quad vertically", () => {
    const { mesh } = Quads.createQuad({ w: 8, h: 8, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    Quads.splitVertical(mesh, mesh.quads[0], 0.25);
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can split a quad horizontally", () => {
    const { mesh } = Quads.createQuad({ w: 8, h: 8, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    Quads.splitHorizontal(mesh, mesh.quads[0], 0.25);
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can split a quad horizontally disjointly", () => {
    const { mesh } = Quads.createQuad({ w: 8, h: 8, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    Quads.splitHorizontalDisjoint(mesh, mesh.quads[0], 0.25);
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can split a quad horizontally disjointly", () => {
    const { mesh } = Quads.createQuad({ w: 8, h: 8, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    Quads.splitVerticalDisjoint(mesh, mesh.quads[0], 0.25);
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚ -3  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -2  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚ -1  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  2  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  3  Â·  â”ƒ  Â·  â”ƒ  Â·  â”Š  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  â—†â”â”â”â”â”â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    for (const p of Quads.getPositions(mesh, mesh.quads[1])) {
      p[0] += 1;
      p[1] += 1;
    }
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  â—†â”â”â”â”â”â—†  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  â”ƒ  Â·  â”ƒ  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -2  Â·  â”ƒ  Â·  â”ƒ  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -1  Â·  â”ƒ  Â·  â”ƒ  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  Â·  â”ƒ  Â·  â”ƒ  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  2  Â·  â”ƒ  Â·  â”ƒ  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  3  Â·  â”ƒ  Â·  â”ƒ  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  4  Â·  â—†â”â”â”â”â”â—†  â”ƒ  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  5  Â·  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );
  });

  it("can clone a quad", () => {
    const { mesh } = Quads.createQuad({ w: 4, h: 4, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -2  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  Â·  Â·
      â”‚ -1  Â·  Â·  Â·  â”ƒ  Â·  â”Š  Â·  â”ƒ  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  Â·  â”ƒ  Â·  â”Š  Â·  â”ƒ  Â·  Â·  Â·
      â”‚  2  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  Â·  Â·
      â”‚  3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );

    Quads.clone(mesh, mesh.quads[0]);
    for (const p of Quads.getPositions(mesh, mesh.quads[0])) {
      p[0] += 2;
      p[1] += 2;
    }
    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -2  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  Â·  Â·
      â”‚ -1  Â·  Â·  Â·  â”ƒ  Â·  â”Š  Â·  â”ƒ  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ—†â”â”â”â”â”â”ƒâ”â”â”â”â”â—†â”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  Â·  â”ƒ  Â·  â”ƒ  Â·  â”ƒ  Â·  â”ƒ  Â·
      â”‚  2  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  Â·  â”ƒ  Â·
      â”‚  3  Â·  Â·  Â·  Â·  Â·  â”ƒ  Â·  Â·  Â·  â”ƒ  Â·
      â”‚  4  Â·  Â·  Â·  Â·  Â·  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can render diagonals (-x, -y)", () => {
    const { mesh } = Quads.createQuad({ w: 4, h: 4, facing: "z+" });
    for (const p of Quads.getPositions(mesh, 0)) {
      p[0] += 3;
      p[1] += 3;
    }
    mesh.positions[0][0] -= 5;
    mesh.positions[0][1] -= 5;

    assertArt(
      mesh,
      "z",
      `
        â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
        â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
        â”‚ -4  Â·  â—†â”â”Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
        â”‚ -3  Â·  Â· âŸâ”â”â”â”â”â”Â·  â”Š  Â·  Â·  Â·  Â·  Â·
        â”‚ -2  Â·  Â·  âŸ  Â·  â”â”â”â”â” Â·  Â·  Â·  Â·  Â·
        â”‚ -1  Â·  Â·  Â· âŸÂ·  Â·  â”Š â”â”â”â”â”  Â·  Â·  Â·
        â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”â”â”â”â”â”â”ˆâ”ˆâ”ˆâ”ˆ
        â”‚  1  Â·  Â·  Â·  Â· âŸÂ·  â”Š  Â·  Â·  Â·  Â·â”â”â—†
        â”‚  2  Â·  Â·  Â·  Â·  Â·âŸ â”Š  Â·  Â·  Â·  Â·  â”ƒ
        â”‚  3  Â·  Â·  Â·  Â·  Â·  âŸ  Â·  Â·  Â·  Â·  â”ƒ
        â”‚  4  Â·  Â·  Â·  Â·  Â·  â”ŠâŸ Â·  Â·  Â·  Â·  â”ƒ
        â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  â—†â”â”â”â”â”â”â”â”â”â”â”â—†
        `
    );
  });

  it("can render diagonals (+x, -y)", () => {
    const { mesh } = Quads.createQuad({ w: 4, h: 4, facing: "z+" });
    for (const p of Quads.getPositions(mesh, 0)) {
      p[0] -= 3;
      p[1] += 3;
    }
    mesh.positions[3][0] += 5;
    mesh.positions[3][1] -= 5;

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·â”â”â—†  Â·
      â”‚ -3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·â”â”â”â”â”â”âŸ‹ Â·  Â·
      â”‚ -2  Â·  Â·  Â·  Â·  Â· â”â”â”â”â”  Â·  âŸ‹  Â·  Â·
      â”‚ -1  Â·  Â·  Â·  â”â”â”â”â” â”Š  Â·  Â·âŸ‹ Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”â”â”â”â”â”â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâŸ‹â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  â—†â”â”Â·  Â·  Â·  Â·  â”Š  Â·âŸ‹ Â·  Â·  Â·  Â·
      â”‚  2  â”ƒ  Â·  Â·  Â·  Â·  â”Š âŸ‹Â·  Â·  Â·  Â·  Â·
      â”‚  3  â”ƒ  Â·  Â·  Â·  Â·  âŸ‹  Â·  Â·  Â·  Â·  Â·
      â”‚  4  â”ƒ  Â·  Â·  Â·  Â· âŸ‹â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can render diagonals (-x, +y)", () => {
    const { mesh } = Quads.createQuad({ w: 4, h: 4, facing: "z+" });
    for (const p of Quads.getPositions(mesh, 0)) {
      p[0] += 3;
      p[1] -= 3;
    }
    mesh.positions[1][0] -= 5;
    mesh.positions[1][1] += 5;

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â·  â”Š  â—†â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  Â·  Â·  Â·  Â·  Â·  â”ŠâŸ‹ Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -3  Â·  Â·  Â·  Â·  Â·  âŸ‹  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -2  Â·  Â·  Â·  Â·  Â·âŸ‹ â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -1  Â·  Â·  Â·  Â· âŸ‹Â·  â”Š  Â·  Â·  Â·  Â·â”â”â—†
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ‹â”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”â”â”â”â”â”â”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  Â· âŸ‹Â·  Â·  â”Š â”â”â”â”â”  Â·  Â·  Â·
      â”‚  2  Â·  Â·  âŸ‹  Â·  â”â”â”â”â” Â·  Â·  Â·  Â·  Â·
      â”‚  3  Â·  Â· âŸ‹â”â”â”â”â”â”Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  4  Â·  â—†â”â”Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("can render diagonals (+x, +y)", () => {
    const { mesh } = Quads.createQuad({ w: 4, h: 4, facing: "z+" });
    for (const p of Quads.getPositions(mesh, 0)) {
      p[0] -= 3;
      p[1] -= 3;
    }
    mesh.positions[2][0] += 5;
    mesh.positions[2][1] += 5;

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â—†  â”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  â”ƒ  Â·  Â·  Â·  Â· âŸâ”Š  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  â”ƒ  Â·  Â·  Â·  Â·  âŸ  Â·  Â·  Â·  Â·  Â·
      â”‚ -2  â”ƒ  Â·  Â·  Â·  Â·  â”Š âŸÂ·  Â·  Â·  Â·  Â·
      â”‚ -1  â—†â”â”Â·  Â·  Â·  Â·  â”Š  Â·âŸ Â·  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”â”â”â”â”â”â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâŸâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  Â·  â”â”â”â”â” â”Š  Â·  Â·âŸ Â·  Â·  Â·
      â”‚  2  Â·  Â·  Â·  Â·  Â· â”â”â”â”â”  Â·  âŸ  Â·  Â·
      â”‚  3  Â·  Â·  Â·  Â·  Â·  â”Š  Â·â”â”â”â”â”â”âŸ Â·  Â·
      â”‚  4  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·â”â”â—†  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  Â·
      `
    );
  });

  it("insets geometry", () => {
    const { mesh } = Quads.createQuad({ w: 10, h: 10, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );

    Quads.inset(mesh, mesh.quads[0], 0.55);

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚ -3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚  4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );
  });

  it("insets geometry disjointly", () => {
    const { mesh } = Quads.createQuad({ w: 10, h: 10, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );

    Quads.insetDisjoint(mesh, mesh.quads[0], 0.55);

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚ -3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚  4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );

    for (const p of Quads.getPositions(mesh, 0)) {
      p[0] += 2;
      p[1] += 2;
    }

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚ -3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ—†â”â”â”â”â”â”â”â”ƒâ”â”â”â”â”â—†â”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â· â”ƒÂ·  Â· â”ƒâ”Š  Â·  Â·â”ƒ Â·  Â·â”ƒ â”ƒ
      â”‚  2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·â”ƒ â”ƒ
      â”‚  3  â”ƒ  Â· â”â”â” Â·  Â· â”ƒâ”Š  Â·  Â· â”â”â” Â·â”ƒ â”ƒ
      â”‚  4  â”ƒ â”â”â” Â·  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );
  });

  it("extrudes geometry", () => {
    const { mesh } = Quads.createQuad({ w: 10, h: 10, facing: "z+" });

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  4  â”ƒ  Â·  Â·  Â·  Â·  â”Š  Â·  Â·  Â·  Â·  â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );

    Quads.extrude(mesh, mesh.quads[0], 0.55, 1);

    assertArt(
      mesh,
      "z",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      â”‚ -4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚ -3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚ -2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚ -1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  0 â”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”Šâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆ
      â”‚  1  â”ƒ  Â·  Â· â”ƒÂ·  Â·  â”Š  Â·  Â·â”ƒ Â·  Â·  â”ƒ
      â”‚  2  â”ƒ  Â·  Â· â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â—† Â·  Â·  â”ƒ
      â”‚  3  â”ƒ  Â· â”â”â” Â·  Â·  â”Š  Â·  Â· â”â”â” Â·  â”ƒ
      â”‚  4  â”ƒ â”â”â” Â·  Â·  Â·  â”Š  Â·  Â·  Â· â”â”â” â”ƒ
      â”‚  5  â—†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—†
      `
    );

    assertArt(
      mesh,
      "x",
      `
      â”‚    -5 -4 -3 -2 -1  0  1  2  3  4  5
      â”‚ -5  Â·  Â·  Â·  Â·  Â· â”â—†  Â·  Â·  Â·  Â·  Â·
      â”‚ -4  Â·  Â·  Â·  Â· â”â”â” â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚ -3  Â·  Â·  Â·â”â”â”â” Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚ -2  Â·  Â·  â—†  Â·  Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚ -1  Â·  Â·  â”ƒ  Â·  Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚  0 â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
      â”‚  1  Â·  Â·  â”ƒ  Â·  Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚  2  Â·  Â·  â—†  Â·  Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚  3  Â·  Â·  Â·â”â”â”â” Â·  â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚  4  Â·  Â·  Â·  Â· â”â”â” â”ƒ  Â·  Â·  Â·  Â·  Â·
      â”‚  5  Â·  Â·  Â·  Â·  Â· â”â—†  Â·  Â·  Â·  Â·  Â·
      `
    );
  });
});

describe("replaceCodepoint", () => {
  it("replaces text from the basic multilingual plane", () => {
    const alphabet = "abcdefghijklmnopqrstuvwxyz";
    expect(replaceCodepoint(alphabet, "_", 3)).toEqual(
      "abc_efghijklmnopqrstuvwxyz"
    );
    expect(replaceCodepoint(alphabet, "ğŸ‘", 3)).toEqual(
      "abcğŸ‘efghijklmnopqrstuvwxyz"
    );
  });

  it("replaces text from higher planes", () => {
    const phrase = "Yes ğŸ‘ sounds good";
    expect(phrase.length).toEqual(18);
    expect([...phrase].length).toEqual(17);
    expect(replaceCodepoint(phrase, "_", 6)).toEqual("Yes ğŸ‘ _ounds good");
  });
});
